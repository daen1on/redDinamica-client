<!-- rating modal -->
<div class="modal fade" id="rating" tabindex="-1" aria-labelledby="ratingTitle" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <form [formGroup]="ratingForm" (ngSubmit)="onSubmit()" class="modal-content">

            <!-- modal-header -->
            <div class="modal-header">
                <h5 class="modal-title" id="ratingTitle">{{title}}</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close" (click)="restartValues()"></button>
            </div>
            <!-- /modal-header -->

            <!-- modal-body -->
            <div class="text-center modal-body">

                <div *ngIf="status === 'error'" class="alert alert-danger fade show text-center" role="alert">
                    <i class="fas fa-times-circle icon-message me-2"></i>
                    {{errorMsg}}
                </div>

                <div *ngIf="status === 'success'" class="alert alert-success fade show text-center" role="alert">
                    <i class="fas fa-check-circle icon-message me-2"></i>
                    {{successMsg}}
                </div>

                <style>
                    /* Estrellas con medias y fondo negro en selección/hover (soporte dark mode) */
                    .clasificacion {
                        display: inline-flex;
                        flex-direction: row-reverse;
                        gap: 6px;
                        direction: rtl;
                        unicode-bidi: bidi-override;
                    }
                    .clasificacion input {
                        display: none;
                    }
                    .clasificacion label {
                        cursor: pointer;
                        padding: 6px;
                        border-radius: 6px;
                        background-color: transparent;
                        transition: background-color .15s ease-in-out, transform .05s ease-in-out;
                    }
                    .clasificacion label:hover,
                    .clasificacion label:hover ~ label {
                        background-color: #000;
                    }
                    .clasificacion input:checked + label,
                    .clasificacion input:checked + label ~ label {
                        background-color: #000;
                    }
                    .clasificacion i.fas {
                        color: #ffc107;
                        font-size: 1.25rem;
                    }
                </style>
                <div class="my-2 clasificacion" aria-label="Calificación por estrellas">
                    <!-- 5.0 -->
                    <input id="res-rate-5" type="radio" name="rating" value="5" formControlName="rating">
                    <label for="res-rate-5" title="5.0" aria-label="5.0"><i class="fas fa-star icon-message"></i></label>
                    <!-- 4.5 -->
                    <input id="res-rate-45" type="radio" name="rating" value="4.5" formControlName="rating">
                    <label for="res-rate-45" title="4.5" aria-label="4.5"><i class="fas fa-star-half-alt icon-message"></i></label>
                    <!-- 4.0 -->
                    <input id="res-rate-4" type="radio" name="rating" value="4" formControlName="rating">
                    <label for="res-rate-4" title="4.0" aria-label="4.0"><i class="fas fa-star icon-message"></i></label>
                    <!-- 3.5 -->
                    <input id="res-rate-35" type="radio" name="rating" value="3.5" formControlName="rating">
                    <label for="res-rate-35" title="3.5" aria-label="3.5"><i class="fas fa-star-half-alt icon-message"></i></label>
                    <!-- 3.0 -->
                    <input id="res-rate-3" type="radio" name="rating" value="3" formControlName="rating">
                    <label for="res-rate-3" title="3.0" aria-label="3.0"><i class="fas fa-star icon-message"></i></label>
                    <!-- 2.5 -->
                    <input id="res-rate-25" type="radio" name="rating" value="2.5" formControlName="rating">
                    <label for="res-rate-25" title="2.5" aria-label="2.5"><i class="fas fa-star-half-alt icon-message"></i></label>
                    <!-- 2.0 -->
                    <input id="res-rate-2" type="radio" name="rating" value="2" formControlName="rating">
                    <label for="res-rate-2" title="2.0" aria-label="2.0"><i class="fas fa-star icon-message"></i></label>
                    <!-- 1.5 -->
                    <input id="res-rate-15" type="radio" name="rating" value="1.5" formControlName="rating">
                    <label for="res-rate-15" title="1.5" aria-label="1.5"><i class="fas fa-star-half-alt icon-message"></i></label>
                    <!-- 1.0 -->
                    <input id="res-rate-1" type="radio" name="rating" value="1" formControlName="rating">
                    <label for="res-rate-1" title="1.0" aria-label="1.0"><i class="fas fa-star icon-message"></i></label>
                    <!-- 0.5 -->
                    <input id="res-rate-05" type="radio" name="rating" value="0.5" formControlName="rating">
                    <label for="res-rate-05" title="0.5" aria-label="0.5"><i class="fas fa-star-half-alt icon-message"></i></label>
                </div>

                <div class="form-group row mt-3">
                    <div class="col-2 align-items-center">
                        <div class=" flex-shrink-0 rounded-circle border-1 overflow-hidden me-2"
                            style="width: 40px; height:40px;">
                            <img *ngIf="!identity.picture" class="img-fluid" src="assets/images/user-default.png">
                            <img *ngIf="identity.picture" class="img-fluid"
                                src="{{this.url+'get-image-user/'+ identity.picture}}">
                        </div>
                    </div>
                    <div class="col ps-0 align-items-center">
                        <textarea class="bg-light" formControlName="text" class="form-control" rows="2"
                            placeholder="Escribe un comentario sobre el recurso..."
                            [ngClass]="{ 'is-invalid': submitted && ratingForm.controls.rating.errors}"></textarea>
                        <div *ngIf="submitted && ratingForm.controls.rating.errors" class="invalid-feedback">
                            <div class="text-start" *ngIf="ratingForm.controls.rating.errors.required">
                                Debes elegir el número de estrellas para calificar el recurso.
                            </div>
                        </div>
                    </div>


                </div>
                <!-- /modal-body -->

                <!-- modal-footer -->
                <div class="modal-footer">
                    <button type="submit" class="btn btn-warning">Enviar calificación</button>
                    <button class="btn btn-secondary" data-bs-dismiss="modal" (click)="restartValues()">Cerrar</button>

                </div>
                <!-- /modal-footer -->
            </div>
        </form>
    </div>
</div>
<!-- /rating -->